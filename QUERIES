-- 1. WHO IS THE PERSON WHO LIFTS THE MOST WEIGHT?
SELECT P.NAME, 
       D.WEIGHT
FROM PERSON P
INNER JOIN WORKOUTS W 
        ON P.ID_PERSON = W.ID_PERSON
INNER JOIN WORKOUT_DETAILS D 
        ON W.ID_WORKOUT = D.ID_WORKOUT
WHERE D.WEIGHT = (
    SELECT MAX(WEIGHT)
    FROM WORKOUT_DETAILS
);

-- 2. WHICH EXERCISE IS PERFORMED THE MOST?
SELECT E.NAME, 
       COUNT(*) AS TIMES_PERFORMED
FROM WORKOUT_DETAILS D
INNER JOIN EXERCISES E 
        ON D.ID_EXERCISE = E.ID_EXERCISE
GROUP BY E.ID_EXERCISE, E.NAME
ORDER BY TIMES_PERFORMED DESC
LIMIT 1;

-- 3. RANKING OF PERSONS FROM MOST TO LEAST WORKOUTS
SELECT P.NAME, 
       COUNT(W.ID_WORKOUT) AS NUM_WORKOUTS
FROM PERSON P
INNER JOIN WORKOUTS W 
        ON P.ID_PERSON = W.ID_PERSON
WHERE W.ATTENDANCE = TRUE
GROUP BY P.ID_PERSON, P.NAME
ORDER BY NUM_WORKOUTS DESC;

-- 4. WHO DOES THE MOST REPETITIONS AND HOW MANY?
SELECT P.NAME, 
       SUM(D.REPETITIONS) AS TOTAL_REPETITIONS
FROM PERSON P
INNER JOIN WORKOUTS W 
        ON P.ID_PERSON = W.ID_PERSON
INNER JOIN WORKOUT_DETAILS D 
        ON W.ID_WORKOUT = D.ID_WORKOUT
GROUP BY P.NAME
ORDER BY TOTAL_REPETITIONS DESC
LIMIT 1;

-- 5. PERSON NAME AND TOTAL EXERCISES BY MUSCLE
SELECT P.NAME, 
       M.NAME AS MUSCLE, 
       COUNT(E.ID_EXERCISE) AS TOTAL_EXERCISES
FROM MUSCLES M
INNER JOIN EXERCISES E 
        ON M.ID_MUSCLE = E.ID_MUSCLE
INNER JOIN WORKOUT_DETAILS D 
        ON E.ID_EXERCISE = D.ID_EXERCISE
INNER JOIN WORKOUTS W 
        ON D.ID_WORKOUT = W.ID_WORKOUT
INNER JOIN PERSON P 
        ON W.ID_PERSON = P.ID_PERSON
GROUP BY P.NAME, M.NAME
ORDER BY P.NAME, TOTAL_EXERCISES DESC;

-- 6. RANKING OF WEEK DAYS WITH MOST WORKOUTS
SELECT WEEK_DAY, 
       COUNT(*) AS ATTENDANCES
FROM WORKOUTS
WHERE ATTENDANCE = TRUE
GROUP BY WEEK_DAY
ORDER BY ATTENDANCES DESC;

-- 7. WHICH FEMALE LIFTS THE MOST WEIGHT?
SELECT P.NAME, 
       D.WEIGHT
FROM PERSON P
JOIN WORKOUTS W 
        ON P.ID_PERSON = W.ID_PERSON
JOIN WORKOUT_DETAILS D 
        ON W.ID_WORKOUT = D.ID_WORKOUT
WHERE P.GENDER = 'F'
ORDER BY D.WEIGHT DESC
LIMIT 1;

-- 8. WHICH MALE LIFTS THE MOST WEIGHT?
SELECT P.NAME, 
       D.WEIGHT
FROM PERSON P
JOIN WORKOUTS W 
        ON P.ID_PERSON = W.ID_PERSON
JOIN WORKOUT_DETAILS D 
        ON W.ID_WORKOUT = D.ID_WORKOUT
WHERE P.GENDER = 'M'
ORDER BY D.WEIGHT DESC
LIMIT 1;

-- 9. IN WHICH EXERCISE IS THE HIGHEST WEIGHT LIFTED?
SELECT E.NAME, 
       D.WEIGHT
FROM EXERCISES E
INNER JOIN WORKOUT_DETAILS D 
        ON E.ID_EXERCISE = D.ID_EXERCISE
ORDER BY D.WEIGHT DESC
LIMIT 1;

-- 10. IN WHICH EXERCISE IS THE LOWEST WEIGHT LIFTED?
SELECT E.NAME, 
       D.WEIGHT
FROM EXERCISES E
INNER JOIN WORKOUT_DETAILS D 
        ON E.ID_EXERCISE = D.ID_EXERCISE
ORDER BY D.WEIGHT ASC
LIMIT 1;

-- 11. WHO IS THE PERSON WHO LIFTS THE LEAST WEIGHT?
SELECT P.NAME, 
       D.WEIGHT
FROM PERSON P
JOIN WORKOUTS W 
        ON P.ID_PERSON = W.ID_PERSON
JOIN WORKOUT_DETAILS D 
        ON W.ID_WORKOUT = D.ID_WORKOUT
ORDER BY D.WEIGHT ASC
LIMIT 1;
